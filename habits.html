<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Habits you go girl</title>
    <style>
        body {
          font-family: sans-serif;
          background: #121212;
          color: white;
          padding: 20px;
        }

        .habit {
          padding: 10px 20px;
          margin: 10px 0;
          background: #1e1e1e;
          border-left: 6px solid #4CAF50;
          cursor: pointer;
          transition: all 0.2s ease;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .habit.done {
          background: #2e7d32;
          text-decoration: line-through;
        }

        .habit:hover {
          opacity: 0.8;
        }

        .habit .points {
          font-weight: 700;
          font-size: 1.1rem;
          padding: 4px 8px;
          border-radius: 6px;
          min-width: 28px;
          text-align: center;
          color: white;
        }

        /* Points colors */
        .points-1 { background: #add8e6; } /* light blue */
        .points-2 { background: #4caf50; } /* green */
        .points-3 { background: #ffeb3b; color: #333; } /* yellow */
        .points-4 { background: #ff9800; } /* orange */
        .points-5 { background: #f44336; } /* red */

        /* Input styles for editing */
        .habit input[type="text"], .habit input[type="number"] {
          font-size: 1rem;
          padding: 4px 8px;
          border-radius: 6px;
          border: none;
          outline: none;
          width: 60%;
          max-width: 200px;
        }
        .habit input[type="number"] {
          width: 40px;
          margin-left: 10px;
        }

        .nav {
          margin-top: 30px;
        }

        .nav a {
          color: #4CAF50;
          text-decoration: none;
          margin-right: 10px;
        }

        .nav a:hover {
          text-decoration: underline;
        }

        /* Bottom nav */
        nav.bottom-nav {
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          height: 60px;
          background: #3a3a3a;
          display: flex;
          justify-content: space-around;
          align-items: center;
          border-top: 2px solid #252525;
          box-shadow: 0 -2px 8px rgba(0,0,0,0.7);
          z-index: 1000;
        }

        nav.bottom-nav a {
          flex: 1;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        nav.bottom-nav img {
          width: 50px;
          cursor: pointer;
        }

        /* Log button container - to position above the nav */
        .log-btn-container {
          position: fixed;
          bottom: 80px; /* just above nav bar */
          left: 48%;
          z-index: 1100;
        }

        /* Log button itself */
        .log-btn {
          width: 56px;
          height: 56px;
          left: -40%;
          border-radius: 50%;
          background: #4caf50; /* dark lime green */
          box-shadow: 0 0 100px #66bb6a;
          border: 2px solid #2e7d32;
          color: white;
          font-size: 30px;
          display: flex;
          justify-content: center;
          align-items: center;
          cursor: pointer;
          user-select: none;
          transition: background 0.3s ease;
          position: relative;
        }
        .log-btn:hover {
          background: #81c784;
          box-shadow: 0 0 15px #a5d6a7;
        }

        /* Tooltip / popup window */
        .log-popup {
          position: absolute;
          bottom: 72px;
          left: 20%;
          right: 20%;
          transform: translateX(-50%);
          background: #333;
          padding: 12px 16px;
          border-radius: 6px;
          box-shadow: 0 0 10px rgba(0,0,0,0.8);
          color: #a5d6a7;
          font-size: 0.9rem;
          white-space: nowrap;
          user-select: none;
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.3s ease;
          width: max-content;
          text-align: center;
          z-index: 1200;
        }

        /* Show popup on hover for desktop */
        .log-btn-container:hover .log-popup {
          opacity: 1;
          pointer-events: auto;
        }

        /* Show popup on active class (for click toggle) */
        .log-btn-container.active .log-popup {
          opacity: 1;
          pointer-events: auto;
        }
    </style>
</head>
<body>
<h1>Track Your Habits</h1>

<div id="habits-list"></div>

<div class="log-btn-container" id="logBtnContainer" tabindex="0" aria-label="Open logging options">
    <div class="log-btn" id="logBtn" role="button" aria-pressed="false" tabindex="0" title="Logging features">✍️</div>
    <div class="log-popup" id="logPopup">
        <strong>Log Feature</strong><br/>
        Take photo, calculate macros, track weight, journal your day!
    </div>
</div>

<nav class="bottom-nav" role="navigation" aria-label="Main navigation">
    <a href="habits.html" aria-label="Go to Habits page">
        <img src="images/Onriselogo.png" alt="Onrise" />
    </a>
    <a href="index.html" aria-label="Go to Dashboard page">
        <img src="images/goldencarrotblackbg.jpg" alt="Golden carrot" />
    </a>
    <a href="settings.html" aria-label="Go to Settings page">
        <img src="images/Settingsblackpng.png" alt="Settings" />
    </a>
</nav>

<script>
    const habitList = document.getElementById('habits-list');

    // Load from localStorage or default
    let habits = JSON.parse(localStorage.getItem('habitsData')) || [
      { name: "Drink Water", points: 2 },
      { name: "Exercise", points: 3 },
      { name: "Read Book", points: 3 },
      { name: "Meditate", points: 2 },
      { name: "U better click me", points: 5 },
      { name: "No zero time spent", points: 4 }
    ];

    // Utility: format date as YYYY-MM-DD
    function getTodayKey() {
      const now = new Date();
      return now.toISOString().split('T')[0];
    }

    function renderHabits() {
      habitList.innerHTML = '';
      const today = getTodayKey();

      habits.forEach((habit, index) => {
        const div = document.createElement('div');
        div.className = 'habit';
        div.textContent = `${habit.name} (${habit.points}pt)`;

        const habitDoneKey = `${today}_${habit.name}_done`;
        const isDone = localStorage.getItem(habitDoneKey) === 'true';
        if (isDone) div.classList.add('done');

        updateColorByPoints(div, habit.points);

        div.addEventListener('click', () => {
          const done = !div.classList.contains('done');
          div.classList.toggle('done');
          localStorage.setItem(habitDoneKey, done);

          // Update points only if marking as done
          if (done) {
            addPointsForToday(habit.points);
          } else {
            subtractPointsForToday(habit.points);
          }
        });

        habitList.appendChild(div);
      });
    }

    function updateColorByPoints(div, points) {
      if (points >= 5) {
        div.style.borderLeftColor = 'red';
      } else if (points >= 4) {
        div.style.borderLeftColor = 'orange';
      } else if (points >= 3) {
        div.style.borderLeftColor = 'yellow';
      } else if (points >= 2) {
        div.style.borderLeftColor = '#4CAF50'; // green
      } else {
        div.style.borderLeftColor = 'lightblue';
      }
    }

    // Total points per day saved separately
    function getDailyPointsKey() {
      return `points_${getTodayKey()}`;
    }

    function getTodayPoints() {
      return parseInt(localStorage.getItem(getDailyPointsKey()) || '0', 10);
    }

    function addPointsForToday(pts) {
      const current = getTodayPoints();
      localStorage.setItem(getDailyPointsKey(), current + pts);
    }

    function subtractPointsForToday(pts) {
      const current = getTodayPoints();
      localStorage.setItem(getDailyPointsKey(), Math.max(0, current - pts));
    }

    window.addEventListener('DOMContentLoaded', renderHabits);
</script>

</body>
</html>
